{{- /* KaTeX CSS (self-hosted) + copy-tex extension (CDN, deferred) */ -}}
<link rel="stylesheet" href="{{ "css/katex.min.css" | relURL }}">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" crossorigin="anonymous"></script>

{{- /* Knowls system - CSS inlined to eliminate render-blocking request */ -}}
<style>
.knowl{color:var(--primary);text-decoration:none;border-bottom:1px dotted var(--primary);cursor:pointer}
.knowl:hover{border-bottom-style:solid}
.knowl[aria-expanded="true"]{font-weight:600}
.knowl-panel{margin:1rem 0;padding:0;border-left:3px solid var(--primary);border-radius:0 8px 8px 0;overflow:hidden}
.knowl-content{padding:0;position:relative}
.knowl-header{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;background:var(--tertiary);border-bottom:1px solid var(--border)}
.knowl-header strong{font-size:.9rem;text-transform:uppercase;letter-spacing:.05em}
.knowl-header-buttons{display:flex;align-items:center;gap:.25rem}
.knowl-close{background:none;border:none;font-size:1.5rem;line-height:1;cursor:pointer;color:var(--primary);padding:0 .25rem}
.knowl-close:hover{opacity:.7}
.knowl-copy{background:none;border:none;font-size:1.4rem;line-height:1;cursor:pointer;color:var(--primary);padding:0 .25rem;transition:opacity .15s ease}
.knowl-copy:hover{opacity:.7}
.knowl-body{padding:1rem}
.knowl-body p:last-child{margin-bottom:0}
.knowl-footer{position:absolute;bottom:.5rem;right:.5rem}
.knowl-loading,.knowl-error{padding:1rem;color:var(--secondary);font-style:italic}
.knowl-error a{color:var(--primary)}
.knowl-panel .knowl-panel{margin-left:.5rem}
.knowl-depth-even{background:var(--theme)}
.knowl-depth-odd{background:var(--code-bg)}
[data-theme="dark"] .knowl-depth-even{background:var(--entry)}
[data-theme="dark"] .knowl-depth-odd{background:var(--theme)}
@media print{
.knowl{color:#000;border-bottom:none;font-weight:600}
.knowl-panel{border:1px solid #000;border-left:3px solid #000;background:none;break-inside:avoid}
.knowl-header-buttons,.knowl-loading,.knowl-error,.knowl-footer{display:none}
.knowl-header{background:none;border-bottom:1px solid #ccc}
.knowl-depth-even,.knowl-depth-odd{background:none}
}
</style>
<script defer src="{{ "js/knowls.js" | relURL }}"></script>
