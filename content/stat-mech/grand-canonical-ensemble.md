---
title: "Grand canonical ensemble"
description: "Gibbs equilibrium distribution at fixed temperature and chemical potential: energy and particle number both fluctuate, normalized by the grand partition function."
---

The **grand canonical ensemble** models a system that can exchange both energy and particles with a reservoir, so temperature and chemical potential are fixed while energy and particle number fluctuate.

It is the natural ensemble for open systems, lattice gases, and quantum gases, and it provides a direct route to the thermodynamic {{< knowl id="grand-potential" section="thermodynamics" text="grand potential" >}} and pressure.

Fix an inverse temperature {{< knowl id="inverse-temperature-beta" section="thermodynamics" text="inverse temperature" >}} $\beta>0$ and a {{< knowl id="chemical-potential-thermo" section="thermodynamics" text="chemical potential" >}} $\mu$. For each particle number $N$, let $\Gamma_N$ be the $N$-particle {{< knowl id="phase-space-classical" text="phase space" >}} (or Hilbert space sector), and let $H_N$ be the corresponding {{< knowl id="hamiltonian-function-classical" text="Hamiltonian" >}}.

The grand canonical weight of a microstate $x\in\Gamma_N$ is proportional to $e^{-\beta(H_N(x)-\mu N)}$. The normalized probability density is
$$
\rho_{\beta,\mu}(N,x)
\;=\;
\frac{e^{-\beta(H_N(x)-\mu N)}}{\Xi(\beta,\mu)},
$$
where the normalizing constant
$$
\Xi(\beta,\mu)
\;=\;
\sum_{N\ge 0}\int_{\Gamma_N} e^{-\beta(H_N(x)-\mu N)}\, d\Gamma_N
$$
is the {{< knowl id="grand-partition-function" text="grand partition function" >}} (also called the grand canonical partition function).

(Quantum version: $\Xi(\beta,\mu)=\mathrm{Tr}\,\exp\{-\beta(\hat H-\mu \hat N)\}$.)

## Ensemble averages
For an observable $A$ that may depend on $N$ and $x$, the {{< knowl id="ensemble-average" text="ensemble average" >}} is
$$
\langle A\rangle_{\beta,\mu}
\;=\;
\sum_{N\ge 0}\int_{\Gamma_N} A(N,x)\,\rho_{\beta,\mu}(N,x)\, d\Gamma_N.
$$

## Derivative formulas (mean values and fluctuations)
Thermodynamic observables are generated by derivatives of $\ln\Xi$ (see {{< knowl id="construction-observables-from-log-z" text="observables from log partition functions" >}}):

- Mean particle number:
$$
\langle N\rangle_{\beta,\mu}
\;=\;
\frac{1}{\beta}\,\frac{\partial}{\partial\mu}\ln \Xi(\beta,\mu).
$$

- Particle-number fluctuations:
$$
\mathrm{Var}_{\beta,\mu}(N)
\;=\;
\frac{1}{\beta^2}\,\frac{\partial^2}{\partial\mu^2}\ln \Xi(\beta,\mu),
$$
which connects directly to response coefficients such as compressibility (a special case of {{< knowl id="susceptibility-stat-mech" text="susceptibilityâ€“fluctuation relations" >}}).

- Mean energy:
$$
\left\langle E\right\rangle_{\beta,\mu}
\;=\;
-\frac{\partial}{\partial\beta}\ln \Xi(\beta,\mu) \;+\; \mu\,\langle N\rangle_{\beta,\mu}.
$$

More generally, mixed derivatives of $\ln\Xi$ generate covariances, fitting into {{< knowl id="construction-fluctuation-formulas-log-z" text="fluctuation formulas from log partition functions" >}}.

## Grand potential and pressure
The thermodynamic grand potential is obtained from $\Xi$ by
$$
\Omega(\beta,\mu)
\;=\;
-\frac{1}{\beta}\ln \Xi(\beta,\mu),
$$
matching the {{< knowl id="grand-potential" section="thermodynamics" text="thermodynamic grand potential" >}} and arising as a {{< knowl id="construction-legendre-f-to-omega" text="Legendre transform of free energy" >}} in equilibrium thermodynamics.

For a homogeneous system of volume $V$, one has $\Omega = -pV$, so the pressure can be read from the partition function as in {{< knowl id="pressure-from-partition-function" text="pressure from the partition function" >}}:
$$
p
\;=\;
\frac{1}{\beta V}\,\ln \Xi(\beta,\mu).
$$

## Relation to other ensembles
If particle-number fluctuations are suppressed (e.g., by conditioning on a fixed $N$), the grand canonical ensemble reduces to the {{< knowl id="canonical-ensemble" text="canonical ensemble" >}}. In the {{< knowl id="thermodynamic-limit" section="thermodynamics" text="thermodynamic limit" >}}, predictions for many bulk observables often coincide across these ensembles under suitable conditions (ensemble equivalence).
